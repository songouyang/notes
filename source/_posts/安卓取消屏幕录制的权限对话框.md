---
title: 安卓取消屏幕录制的权限对话框
comments: true
mathjax: false
toc: false
abbrlink: 26163
date: 2020-11-29 13:52:57
tags:
  - ADB
  - 安卓
categories: 软件技巧
thumbnail:
---

和平精英、王者荣耀，开启精彩时刻录制功能后，每次游戏开局时都需要点击「要开始使用和平精英录制或投射内容」或者「在投射/录制时显示敏感信息」的权限对话框，极度影响游戏开局的体验。借助 ADB 工具，无需 ROOT 权限，使用 AppOps 命令管理软件权限，一劳永逸解决开局弹出权限对话框的问题。

<!--more-->

从安卓 10 版本开始，第三方软件使用投屏功能时，系统将弹出安全警告。程序每次使用投屏或者录制权限时，都需要经过用户的确认才能正常工作。

{% img //sf6-ttcdn-tos.pstatp.com/obj/mosaic-legacy/13843000270a6efca071c "要开始使用和平精英录制或投射内容吗？"%}

AppOps 是安卓 4.3 加入的权限授权框架，虽然安卓 6 之后有了新的方案：Android Runtime Permission，但是 AppOps 仍然生效，只是没有图形管理界面。

首先电脑需要安装 ADB 工具，然后手机在开发者模式中启动 USB 调试模式，最后连接手机和电脑。确定被授权软件的包名，和平精英的包名是：com.tencent.tmgp.pubgmhd。在电脑的终端启动 ADB，接下来使用 AppOps 框架给和平精英添加 PROJECT_MEDIA 的权限。如果想撤回 PROJECT_MEDIA 权限，只需要把命令中的 allow 改成 ignore 即可。

```sh
$ adb shell
OnePlus8T:/ $ appops set com.tencent.tmgp.pubgmhd PROJECT_MEDIA allow
OnePlus8T:/ $
```

同样的道理，对王者荣耀（包名：com.tencent.tmgp.sgame）执行类似的命令，理论上也是行得通，未实际测试。
