---
title: 安卓关闭屏幕录制或投射内容的弹窗
comments: true
mathjax: false
toc: false
abbrlink: 26163
date: 2020-11-29 13:52:57
tags: ADB
categories: 软件技巧
thumbnail:
cover: /data/thumbnails/26163.png
---

玩和平精英、王者荣耀游戏，开启精彩时刻录制后，每次游戏开局时都需要点击「要开始使用和平精英录制或投射内容」或者「在投射/录制时显示敏感信息」的确认框，极度影响开局的体验。使用 ADB 的 AppOps 命令对游戏授权，一劳永逸解决开局弹窗问题。

<!--more-->

从安卓 10 版本开始，第三方软件使用投屏功能时，系统将弹出安全警告。

{% asset_img "pubg_casting.jpeg" '"要开始使用和平精英录制或投射内容吗？" "要开始使用和平精英录制或投射内容吗？"'%}

AppOps 是安卓 4.3 加入的权限授权框架，安卓 6 之后引入了新的方案：Android Runtime Permission，但是 AppOps 的 API 仍然可以使用，只是没有图形管理界面。AppOps 命令可以在 ADB 的 Shell 中执行。

手机开启开发者调试模式，并且与电脑连接成功，然后启动 ADB 的 Shell。首先确定被授权软件的包名，比如和平精英的包名是：com.tencent.tmgp.pubgmhd。接下来使用 AppOps 给和平精英添加 PROJECT_MEDIA 的权限。如果想撤回 PROJECT_MEDIA 权限，只需要把命令的 allow 改成 ignore 即可。

```sh
$ adb shell
OnePlus8T:/ $ appops set com.tencent.tmgp.pubgmhd PROJECT_MEDIA allow
OnePlus8T:/ $
```

同样的道理，对王者荣耀（包名：com.tencent.tmgp.sgame）执行类似的命令，理论上也是行得通，未实际测试。
